tree("Root")
	parallel
		repeat mute tree("BeAlive")
		repeat mute tree("Die")

tree("BeAlive")
	fallback
		tree("Confrontation")
		tree("ChaseEnemy")
		tree("Idle")

tree("Confrontation")
	sequence
		HasTarget
		IsTargetInRange(7.0)
		UpdateFearStateTask
		GenerateAITransition	
		fallback
			sequence
				CheckInIdleState 
				DodgeNotInCooldown
				CheckAITransitionInRange(0.0, 0.8)
				IsTargetInRange(2.2)
				CheckInFear
				tree("BackRoll")
			sequence
				CheckInIdleState 
				IsTargetInRange(2.2)
				CheckAITransitionInRange(0.0, 0.3)
				tree("AttackMelee")
			sequence
				CheckInIdleState 
				DodgeNotInCooldown
				CheckAITransitionInRange(0.0, 0.4)
				fallback
					sequence
						IsTargetInRange(2.2)
						tree("BackRoll")
					sequence
						not IsTargetInRange(5.0)
						not CheckInFear
						tree("FrontRoll")
					Fail
			sequence
				CheckInIdleState 
				not IsTargetInRange(3.0)
				not CheckInFear
				CheckAITransitionInRange(0.0, 0.15)
				Wait(0.2)
				tree("Execute")
			sequence
				CheckInIdleState 
				not IsTargetInRange(3.0)
				CheckInFear
				CheckAITransitionInRange(0.0, 0.10)
				Wait(0.35)
				tree("Execute")
			sequence
				CheckInIdleState 
				CheckAITransitionInRange(0.0, 0.65)
				tree("Dodge")
		
			sequence
				CheckAITransitionInRange(0.0, 0.75)
				tree("Surrounding")
			sequence
				IsTargetInRange(7.0)
				not IsTargetInRange(3.0)
				StopMove
				ResetAITransition
				Wait(0.4)
			sequence
				ResetAITransition
				Wait(0.4)
						
				



tree("ChaseEnemy")
	while not GetHit
		sequence
			HasTarget
			not IsTargetInRange(7.0)
			UpdateFearStateTask
			SetInCrowd(false)
			fallback
				sequence
					not CheckInFear
					KeepMove(4.0)
				sequence
					KeepMove(5.0)
			

tree("Surrounding")
	while not GetHit
		sequence
			IsTargetInRange(7.0)
			SetInCrowd(true)
			ResetAITransition
			BeginMove	
			fallback
				sequence
					not CheckInFear
					Wait(0.8)
				sequence
					Wait(1.2)
	

tree("Dodge")
	while not GetHit
		sequence
			StopMove
			Wait(0.10)
			SetInputVectorToFaceTarget 
			GenerateAITransition	
			fallback
				sequence
					CheckAITransitionInRange(0.0, 0.6)
					IsTargetInRange(2.5)
					DodgeBack
					WaitForTransition (1)
					sequence
						GenerateAITransition	
						CheckAITransitionInRange(0.0, 0.7)
						not IsTargetInRange(4.0)
						not CheckInFear
						tree("Execute")
				sequence
					CheckAITransitionInRange(0.0, 0.5)
					IsTargetInRange(4.0)
					not IsTargetInRange(2.0)
					RandomOrbitalDodge
					WaitForTransition (1)
				sequence
					CheckAITransitionInRange(0.0, 0.6)
					not IsTargetInRange(3.5)
					not CheckInFear
					DodgeFront
					WaitForTransition (1)
					sequence
						GenerateAITransition	
						CheckAITransitionInRange(0.0, 0.7)
						IsTargetInRange(2.5)
						tree("AttackMelee")
				sequence
					ResetAITransition
					Fail
			ResetAITransition
		

tree("FrontRoll")
	while not GetHit
		sequence
			StopMove
			SetInputVectorToFaceTarget 
			ResetAITransition
			DodgeCommandInput
			Wait(0.20)
			DodgeCommandCancel
			WaitForTransitionNotLessThan (1)
			GenerateAITransition	
			fallback
				sequence
					IsTargetInRange(3.2)
					SetInputVectorToFaceTarget 
					tree("AttackMelee")
				ResetAITransition

tree("BackRoll")
	while not GetHit
		sequence
			StopMove
			SetInputVectorBackToTarget 
			ResetAITransition
			DodgeCommandInput
			Wait(0.20)
			DodgeCommandCancel
			WaitForTransitionNotLessThan (1)
			GenerateAITransition	
			fallback
				sequence
					not CheckInFear
					CheckAITransitionInRange(0.0, 0.7)
					not IsTargetInRange(3.0)
					SetInputVectorToFaceTarget 
					tree("Execute")
				ResetAITransition

tree("AttackMelee")
	while not GetHit
		sequence
			StopMove
			//WaitRandom(0.2, 0.4)
			SetInputVectorToFaceTarget 
			ResetAITransition
			AttackCommandInput
			Wait(0.20)
			AttackCommandCancel
			WaitForTransitionNotLessThan (1)
			GenerateAITransition	
			sequence
				fallback
					sequence
						CheckAITransitionInRange(0.0, 0.7)
						IsTargetInRange(4.0)
					IsTargetInRange(2.5)
				SetInputVectorToFaceTarget 
				AttackCommandInput
				Wait(0.20)
				AttackCommandCancel
				WaitForTransitionNotLessThan (1)
				GenerateAITransition	
				sequence
					fallback
						sequence
							CheckAITransitionInRange(0.0, 0.7)
							IsTargetInRange(4.0)
						IsTargetInRange(2.5)
					SetInputVectorToFaceTarget 
					AttackCommandInput
					Wait(0.20)
					AttackCommandCancel
				ResetAITransition


tree("Execute")
	while not GetHit
		sequence
			StopMove
			SetInputVectorToFaceTarget 
			ResetAITransition
			ExecuteCommandInput
			Wait(0.20)
			ExecuteCommandCancel
			Wait(0.30)
			WaitForTransitionNotLessThan (1)
			fallback
				sequence
					IsTargetInRange(2.5)
					SetInputVectorToFaceTarget 
					ExecuteCommandInput
					Wait(0.20)
					ExecuteCommandCancel
					WaitForTransitionNotLessThan (1)
				Wait(0.6)
	

tree("Idle")
	while
		sequence
			not HasTarget
			not FindTarget

		repeat
			Wait(1.0)


tree("Die")
	IsDead